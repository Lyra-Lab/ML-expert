{
  "id": "arxiv_2502.20022v1",
  "text": "Submitted to IEEE Transactions on Power Systems \n \n1\nDynamic Energy Flow Analysis of Integrated Electricity and Gas \nSystems: A Semi-Analytical Approach \n \nZhikai Huang, Student Member, IEEE, Shuai Lu, Wei Gu, Senior Member, Ruizhi Yu, \nSuhan Zhang, Yijun Xu, Senior Member, IEEE, Yuan Li \n \nAbstract‚ÄîEnsuring the safe and reliable operation of integrated \nelectricity and gas systems (IEGS) requires dynamic energy flow \n(DEF) simulation tools that achieve high accuracy and \ncomputational \nefficiency. \nHowever, \nthe \ninherent \nstrong \nnonlinearity of gas dynamics and its bidirectional coupling with \npower grids impose significant challenges on conventional \nnumerical algorithms, particularly in computational efficiency \nand accuracy. Considering this, we propose a novel non-iterative \nsemi-analytical algorithm based on differential transformation \n(DT) for DEF simulation of IEGS. First, we introduce a semi-\ndiscrete difference method to convert the partial differential \nalgebraic equations of the DEF model into ordinary differential \nalgebraic equations to resort to the DT. Particularly, by employing \nspatial central difference and numerical boundary extrapolation, \nwe effectively avoid the singularity issue of the DT coefficient \nmatrix. Second, we propose a DT-based semi-analytical solution \nmethod, which can yield the solution of the DEF model by \nrecursion. Finally, simulation results demonstrate the superiority \nof the proposed method. \n \nIndex Terms‚ÄîDifferential transformation, dynamic energy \nflow, integrated energy systems, nature gas system, partial \ndifferential algebraic equations, semi-analytical algorithm. \nI. \nINTRODUCTION \nA. \nBackground \nNTEGRATED energy systems have become crucial for \naddressing growing energy demands and sustainability \nchallenges through multi-energy coordination [1]. The synergy \nbetween natural gas networks (NGN) and electric power \nsystems (EPS) significantly enhances energy efficiency and \nreduces emissions [2], yet their complex interdependencies \npose operational risks that demand rigorous analysis. The \nemergence of power-to-gas (P2G) technology is transforming \nNGN-EPS interactions from unidirectional to bidirectional \nexchanges [3], further adding complexity to integrated \nelectricity and gas system (IEGS) operations. \nThe dynamic energy flow (DEF) analysis is a critical \nfoundation for evaluating the operational security of IEGS, \nrequiring large-scale nonlinear partial differential algebraic \nequations (PDAEs). While numerical approaches like finite \ndifference methods (FDMs) [3, 4] and characteristic line \nmethods [5] have been explored for the DEF analysis, they face \ncomputational bottlenecks, including intensive computational \ncost and convergence issues because of the nonlinear NGN and \nEPS equations. In light of this, we develop a semi-analytical \n(SA) algorithm that features high accuracy and low \ncomputational cost for the DEF analysis of IEGS, offering an \nefficient tool for the operational analysis of IEGS. \nB. \nLiterature Review \nThe energy flow analysis of IEGS can be divided into the \nsteady one and the dynamic one based on the energy flow \ntransport models it uses. The steady energy flow analysis uses \nalgebraic equations (AEs) to describe the gas flows in the \npipelines by ignoring the dynamic evolution process, focusing \non the long-term (usually above hours) operational conditions \nof the systems [6]. Comparatively, the DEF analysis uses partial \ndifferential equations (PDEs) to describe the gas flow dynamics \nalong the pipelines, focusing on the short-term (from seconds \nto minutes) operational conditions of the systems [7].  \nThis work focuses on the DEF analysis problem of IEGS, \nwhich is typically large-scale nonlinear PDAEs because of the \noccurrence of the nonlinear gas dynamics in NGN and the \nnonlinear power flow in EPS. To solve the DEF model, the \ntraditional numerical methods consist of two steps: 1) \nDiscretizing the PDEs into AEs using methods such as FDMs \nand finite volume methods; 2) Solving the nonlinear AEs using \niterative methods, typically including Newton‚Äôs method, Quasi-\nNewton method, and Levenberg-Marquardt Method. For \nexample, in [8], the implicit Euler difference schemes are used \nto discretize the PDEs of gas flow, and in [4], the centered-\ndifference form in space and the fully implicit algorithm in time \nare proposed for the gas flow equations and then compared with \nother difference schemes under Newton‚Äôs method. Although \nthe numerical methods are easy to use, they have some inherent \ndrawbacks. First, in the discretization step, to ensure stability \nand accuracy, the temporal and spatial steps cannot be too large \nand need to satisfy some specific constraints, which usually \nintroduce many variables and equations, greatly increasing the \nproblem scale. Second, in solving the nonlinear AEs, it is very \nchallenging to select a starting point that is guaranteed to be in \nthe convergence region [9], which is still an open problem in \nthe field of nonlinear system computation. \nConsidering the shortcomings of the numerical methods, the \nSA approaches have received some attention in recent years, \nsuch as the differential transformation (DT) and the \nholomorphic embedded (HE) methods [10-12], featuring the \nrigorousness of analytical methods and the flexibility of \nnumerical methods. Particularly, the SA approaches do not \nrequire iterative calculation to solve nonlinear problems and \nthus outperform in calculation accuracy and convergence. In the \nfield of energy systems, the SA approach was first utilized to \nsolve the power flow model with AEs and electromechanical \ntransient simulation with ordinary differential algebraic \nequations (ODAEs) [13, 14]. By contrast, designing an efficient \nSA-based algorithm for the DEF model of IEGS is more \nchallenging since it is a nonlinear PDAE model. \nRecently, the SA approaches have also been explored in the \nfield of integrated energy systems. Yu et al. [15] first \ninvestigate the DT-based SA approach for solving the DEF \nI\n\n\nHuang, et al. Dynamic Energy Flow Analysis of Integrated Electricity and Gas Systems: A Semi-Analytical Approach \n2\nmodel of integrated heat and electricity systems. Zhang et al. \n[16] and Huang et al. [17] explore the HE-based SA approach \nfor solving the DEF model of IEGS, in which the treatment of \ndifference schemes and boundary conditions may cause some \nproblems. Specifically, their approach encounters singularities \nin the coefficient matrix of the equations when addressing loop \nnetworks or multiple gas source problems in NGN due to \ninconsistent pressures at pipeline tail converging on the same \nnode. In [16], an assumption of equal pressures at the head and \ntail of the last segment of these pipelines is made, which may \nintroduce computational errors. Overall, the SA approach for \nthe DEF models is still in the initial stage. The research gaps \ninclude: 1) How to efficiently deal with the PDAE model of \nNGN in the SA approach is still unsolved; 2) it remains unclear \nhow to exploit the special structure of the DEF model in IEGS \nto improve the computing performance. \nC. \nContributions \nTo bridge the aforementioned research gaps, we propose a \nnovel SA algorithm for the DEF model of IEGS, which features \nhigher \ncomputation \nefficiency \nand \nrobustness \nwhile \nmaintaining \nhigh \naccuracy. \nCase \nstudies \nverify \nthe \neffectiveness of the proposed method. The main contributions \nare summarized as follows. \n(1) We propose a novel non-iterative DT-based algorithm for \nthe DEF model of IEGS. Compared with the numerical method, \nit avoids the iterative calculation of the equation and greatly \nreduces the number of matrix inversions. \n(2) We propose a spatial difference scheme and a numerical \nboundary construction method to convert the PDE of gas \ndynamics into ODAEs to resort to the SA approach, solving the \ncoefficient matrix singularity problem in the SA approach and \nfeaturing the 2nd-order spatial precision. \n(3) We propose an adaptive window control technique for the \nDT-based DEF calculation, which uses estimated truncation \nerrors to adjust the size of each time window for higher \nrobustness. \nII. \nPROBLEM DESCRIPTION \nIn this section, we first present the DEF model of IEGS. \nSecond, the initial and boundary conditions for solving the DEF \nmodel are formulated. Finally, the classical FDM-based \nnumerical algorithm for the DEF model is briefly introduced. \nA. \nDynamic Energy Flow Model \nThe DEF model of IEGS includes the NGN model, the EPS \nmodel, and the coupling components model, which are \nintroduced separately in the following.  \n1) \nNatural gas network \nThe NGN transports natural gas from source nodes to load \nnodes through pipelines. The NGN model describes the gas \ndynamics in the pipelines and the mass conservation and \npressure consistency at the nodes. The schematic of the NGN \nmodel is given in Fig. 1. \nThe gas dynamics in the pipeline can be described by the \nmass conservation and momentum conservation equations [18]. \nIn this work, we adopt the following assumptions widely used \nin existing work [3, 19] to model the gas dynamics including: \n1) The pipeline is horizontal; 2) The gas transmission in \npipelines is a constant temperature process; 3) The convection \nin the pipeline is negligible. Under these assumptions, the gas \ndynamics in the pipeline can be described by the continuity \nequation (1a) and momentum equation (1b), as: \n \n2\n0\npl\npl\nj\nj\nj\nm\nc\nt\nS\nl\nÔÅ∞\nÔÇ∂\nÔÇ∂\n+\n=\nÔÇ∂\nÔÇ∂\n, \n(1a) \n \n0\n2\npl\npl\npl\npl\nj\nj\nj\nj\nj\nj\npl\nj\nj\nj\nc m\nm\nm\n+ S\n+\n=\nt\nl\n2D S\nÔÅ¨\nÔÅ∞\nÔÅ∞\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\n, \n(1b) \nwherein ùëó= 1,2, ‚ãØ, ùêΩ is the index of the pipeline; ùêΩ is the \nnumber of pipelines in NGN; ùëÜùëó is the cross-sectional area of \npipeline ùëó, m2; ùúÜùëó is the friction factor of pipeline ùëó; ùê∑ùëó is the \ndiameter of pipeline ùëó, m; ùëê is the sound velocity in gas, m s\n‚ÅÑ ; \nùúãùëó\nùëùùëô is the gas pressure of pipeline ùëó, Pa; ùëöùëó\nùëùùëô is mass flow of \npipeline ùëó, kg s\n‚ÅÑ . \nHere, since ùúãùëó\nùëùùëô and ùëöùëó\nùëùùëô are spatially distributed along the \npipeline ùëó, as indicated in Fig. 1, in the following, we use \nùëöùëó\nùëùùëô(ùëô, ùë°)  and ùúãùëó\nùëùùëô(ùëô, ùë°) , ùëô‚àà[0, ùêøùëó], ùë°‚àà[0, ùëá]  to denote their \nvalues in the location ùëô and time ùë° to facilitate the modeling of \nnodes, wherein ùêøùëó is the length of pipeline ùëó and ùëá is the \nsimulation duration, respectively. Especially we use ùëöùëó\nùëùùëô(0, ùë°) \nand ùúãùëó\nùëùùëô(0, ùë°)  (or ùëöùëó\nùëùùëô(ùêøùëó, ùë°)  and ùúãùëó\nùëùùëô(ùêøùëó, ùë°) ) to denote the \nvalues at the head (or tail) of pipeline ùëó at time ùë°. \nNext, we introduce three matrixes to describe the mass \nconservation and pressure consistency at the nodes, including \nùêæùëñùëõ‚àà‚Ñùùêº√óùêΩ, ùêæùëúùë¢ùë°‚àà‚Ñùùêº√óùêΩ, and ùêæùëêùëöùëù‚àà‚Ñùùêº, wherein ùêº is the \nnumber of nodes in NGN. Their elements are defined as: \n \nIf the gas in pipeline  flows into node \n,\nOtherw\n1,\ni\n0\nse\nin\nij\nK\nj\ni\nÔÉ¨\n= ÔÉ≠\nÔÉÆ\n, \n \n \nIf the gas in pipeline  flows out of node \n,\nOtherw\n,\ns\n1\ni\n0\ne\nout\nij\nK\nj\ni\nÔÉ¨\n= ÔÉ≠\nÔÉÆ\n, \n \nIf node  has the\ni\n,\ncompr\n \n,\nOtherw se\ns\ne sor\n1\ncmp\ncmp\nik\nK\ni\nÔÉ¨ÔÉØ\n= ÔÉ≠ÔÉØÔÉÆ\n, \nwherein ùêæùëñùëõ and ùêæùëúùë¢ùë° describe the connection relationship \nbetween pipelines and nodes, respectively; ùêæùëêùëöùëù denotes the \nexistence of compressors at nodes; ùëòùëñ\nùëêùëöùëù is the pressure ratio of \nthe compressor at node ùëñ. \nThen, the nodal mass conservation equations are as: \n \n( )\n(\n)\n(\n)\n0,\n,\nou\ni\nnd\np\nt\nn\nl\npl\nm\nt\n= K\nm\nt\nm\nK\nt\nL\n‚àí\n, \n(1c) \nwherein ùëöùëõùëë(ùë°) ‚àà‚Ñùùêº is the vectors of injection mass flow of \nnodes at time ùë°; ùëöùëùùëô(0, ùë°) = [ùëö1\nùëùùëô(0, ùë°)   ùëö2\nùëùùëô(0, ùë°) ‚ãØ \nFig. 1. Diagram of the model of NGN. \n      \n    \n  ,0\n  ,1\n  ,2\n  , \n  ,  \n   \n  ,  \n    1\n  ,  \n    2\n  \n    \n  \n   \n  \n  \n         \n     \n \n\n\nSubmitted to IEEE Transactions on Power Systems \n \n3\nùëöùêΩ\nùëùùëô(0, ùë°)]\n‚ä§‚àà‚ÑùùêΩ and ùëöùëùùëô(ùêø, ùë°) = [ùëö1\nùëùùëô(ùêø1, ùë°)   ùëö2\nùëùùëô(ùêø2, ùë°) ‚ãØ \nùëöùêΩ\nùëùùëô(ùêøùêΩ, ùë°)]\n‚ä§‚àà‚ÑùùêΩ are the vectors of the gas mass flow at the \nhead and tail of all the pipelines, respectively; ùêø=\n[ùêø1   ùêø2 ‚ãØùêøùêΩ] ‚àà‚ÑùùêΩ. \nThe pressure consistency equations are as: \n \n(\n)\n( )\n(\n)\n,\nnd\npl\nin\nt\nL t\n=\nK\nÔÅ∞\nÔÅ∞\n, \n(1d) \n \n(\n)\n(\n)\n( )\n(\n)\ng\n0\ni\n,\nd a\nnd\np\np\nl\ncm\nout\nt\nt\nK\n=\nK\nÔÅ∞\nÔÅ∞\n, \n(1e) \nwherein ùúãùëõùëë(ùë°) ‚àà‚Ñùùêº is the vectors of gas pressure of nodes at \ntime ùë°; ùúãùëùùëô(0) = [ùúã1\nùëùùëô(0, ùë°)   ùúã2\nùëùùëô(0, ùë°) ‚ãØ ùúãùêΩ\nùëùùëô(0, ùë°)]\n‚ä§‚àà‚ÑùùêΩ; \nùúãùëùùëô(ùêø, ùë°) = [ùúã1\nùëùùëô(ùêø1, ùë°)   ùúã2\nùëùùëô(ùêø2, ùë°) ‚ãØ ùúãùêΩ\nùëùùëô(ùêøùêΩ, ùë°)]\n‚ä§‚àà‚ÑùùêΩ\n are \nthe vectors of the gas pressure flow at the head and tail of all \nthe pipelines, respectively. \n2) \nElectrical power system \nIn this work, we use the steady-state power flow model in a \nrectangular coordinate system for the EPS model, as follows: \n \n( )(\n)\n( )(\n)\ndiag\ndiag\np\ne\nGe\nBf\nf\nBe\nGf\n=\n‚àí\n+\n+\n, \n(1f) \n \n( )(\n)\n( )(\n)\ndiag\ndiag\nq\nf\nGe\nBf\ne\nBe\nGf\n=\n‚àí\n‚àí\n+\n, \n(1g) \n \n( )\n( )\n( )\ndiag\ndiag\ndiag\ne e\nf\nf\nU U\n+\n=\n, \n(1h) \nwherein ùê∫ and ùêµ are the conductance and susceptance matrices; \nùëù‚àà‚ÑùùëÅùëÉùëÑ+ùëÅùëÉùëâ and ùëû‚àà‚ÑùùëÅùëÉùëÑ are the vectors of active and \nreactive power injected into the buses, respectively; ùëà‚àà‚ÑùùëÅùëÉùëâ \nis the vector of bus voltage magnitude on PV buses; ùëí‚àà‚ÑùùëÅùëèùë¢ùë† \nand ùëì‚àà‚ÑùùëÅùëèùë¢ùë† are the vectors of real and imaginary parts of the \nvoltage on buses, respectively; ùëÅùëÉùëÑ, ùëÅùëÉùëâ, and ùëÅùëèùë¢ùë† are the \nnumbers of the PQ, PV, and total buses, respectively. \n3) \nCoupling Components \nTypically, the coupling components between NGN and EPS \ninclude electricity-driven compressors, gas-fired turbines (GT), \nand P2G equipment. For the electricity-driven compressor with \nknown pressure ratios at node ùëñ in NGN and bus ùëè in EPS, we \nuse the linear model to calculate the power consumption [20], \nas: \n \n(\n)\n(\n)\n,\n,\n0,\ntan\nout\nC\ni\nb\nb\nC\npl\nb i\nb\nb\nK\nK\nS\nm\ni\nt\nq\np\np\nb\nÔÅ±\nÔÄ¢\nÔÉé\n= ‚àí\n=\n, \n(1i) \nwherein ùêæùëè,ùëñ\nùê∂ is the efficiency of the gas compressor; ùúÉùëè is the \nphase difference angle of the compressor; ùëùùëè and ùëûùëè are the \nactive and reactive power injection for the bus where the \ncompressor is located, respectively; vector ùêæùëñ\nùëúùë¢ùë° is the ùëñth row \nof the matrix ùêæùëúùë¢ùë°; ùëÜùê∂ is the set of NGN nodes and EPS bus \nlabels where all compressors are located. \nFor the GT that is located at node ùëñ in NGN and supplies \npower at bus ùëè in EPS, the generated power is calculated as [3]: \n \n(\n)\n,\n,\nGFU\ni\ni\nGT\nnd\nb\nb\np =\nK\ni b\nm\nS\n‚àí\nÔÄ¢\nÔÉé\n, \n(1j) \nwherein ùêæùëè,ùëñ\nùê∫ùëá is the conversion efficiency of gas into electricity; \nùëùùëè is the active power injection for the bus where the GT is \nlocated; ùëöùëñ\nùëõùëë is the gas injection for the node where the GT is \nlocated; ùëÜùê∫ùëá is the set of NGN nodes and EPS bus labels where \nall GTs are located. \nFor the P2G that is located as bus ùëè in EPS and supplies gas \nat node ùëñ in NGN, the gas output can be calculated as [16]: \n \n(\n)\n2\n,\n2\n,\ntan\nP G\ni\ni\nb\nb\nnd\nP G\nb\nb\nb\n=\nK\nm\np\nS\ni b\np\nq\nÔÅ±\nÔÉé\n=\n‚àí\nÔÄ¢\n, \n(1k) \nwherein ùêæùëè,ùëñ\nùëÉ2ùê∫ is the conversion efficiency of electricity into gas; \nùúÉùëè is the phase difference angle of the P2G; ùëùùëè and ùëûùëè are the \nactive and reactive power injection for the bus where the \ncompressor is located, respectively; ùëöùëñ\nùëõùëë is the gas injection for \nthe node where the P2G is located; ùëÜùëÉ2ùê∫ is the set of NGN \nnodes and EPS bus where the P2Gs are located. \nB. \nInitial and Boundary Conditions \nFor the DEF model, the initial and boundary conditions are \nthe prerequisites for the uniqueness of the solution. The initial \nconditions provide the initial values of states for solving the \n(partial) differential equations, while the boundary conditions \noffer state constraints at the boundaries of the systems. In the \ncontext of IEGS, the initial conditions define the initial states of \nthe gas pressure and mass flow of the gas pipelines at the \nbeginning of the simulation, as: \n \n(\n)\n( )\n0,\n,\n1,2,\n,\nini\npl\nj\nj\nt\nj\nl,0 =\nl\nL\nj\nJ\nl\nÔÅ∞\nÔÅ∞\nÔÉ©\nÔÉπ\nÔÄ¢ÔÉé\n=\nÔÉ´\nÔÉª\n, \n(1l) \n \n(\n)\n( )\n0,\n,\n1,2,\n,\ninit\npl\nj\nj\nj\nl,0 = m\nl\nl\nL\nj\nJ\nm\nÔÉ©\nÔÉπ\nÔÄ¢ÔÉé\n=\nÔÉ´\nÔÉª\n, \n(1m) \nwherein ùúãùëó\nùëñùëõùëñùë° and ùëöùëó\nùëñùëõùëñùë° are the initial values of pipeline \npressure and mass flow, respectively. \nThe boundary conditions include the ones of NGN, EPS, and \ncoupling components. For NGN, the boundary conditions \ninclude the gas pressure of gas source nodes and the mass flow \nof load nodes, as: \n \n( )\n( )\nc\nnd\nsrc\nsr\ni\n=\nt\ni\nS\nt\nÔÅ∞\nÔÅ∞\nÔÄ¢ÔÉé\n, \n(1n) \n \n( )\n( )\nd\nnd\nld\nl\ni\nm\n=\nt\nt\ni\nm\nS\nÔÄ¢ÔÉé\n, \n(1o) \nwherein ùúãùë†ùëüùëê‚àà‚ÑùùëÅùë†ùëüùëê is the known vector of pressure of source \nnodes; ùëöùëôùëúùëéùëë‚àà‚ÑùùëÅùëôùëë is the known vector of the mass flow of \nload nodes; ùëÅùë†ùëüùëê and ùëÅùëôùëë are the number of source and load \nnodes in NGN, respectively; ùëÜùë†ùëüùëê and ùëÜùëôùëë are the set of source \nand load nodes in NGN, respectively. \nFor EPS, the boundary conditions include the injected active \npower ùëùùëÉùëâ(ùë°) and voltage amplitude ùëàùëÉùëâ(ùë°) of PV buses, the \ninjected active power ùëùùëÉùëâ(ùë°) and reactive power ùëûùëÉùëâ(ùë°) of PQ \nbuses, and the real parts ùëíùë†ùëôùëò(ùë°) and imaginary ùëìùë†ùëôùëò(ùë°) of the \nvoltage of the slack bus, as: \n \n( )\n( )\n( )\n( )\n,\nb\nPV\nPV\nPV\nb t\nt\np\n= p\nt U\n=U\nt\nb\nS\nÔÄ¢ÔÉé\n, \n(1p) \n \n( )\n( )\n( )\n( )\n,\nb\nP\nP\nQ\nQ\nQ\nP\nb t\nt\np\n= p\nt\nq\n= q\nt\nb\nS\nÔÄ¢ÔÉé\n, \n(1q) \n \n( )\n( )\n( )\n( )\n,\nb\nslk\nlk\nsl\nb\ns\nk\ne\n=\nt\nt\n= e\nt\nf\nf\nt\nb\nS\nÔÄ¢ÔÉé\n, \n(1r) \nwherein ùëÜùëÉùëâ, ùëÜùëÉùëÑ, and ùëÜùë†ùëôùëò are the sets of labels for PV, PQ, \nand slack bus, respectively.  \nFurthermore, the boundary conditions for coupling \ncomponents hinge on their respective control strategies. \nElectricity-driven compressors, serving as PQ buses in EPS, \nhave their active and reactive power determined by the mass \nflow through them in NGN via the equation (1i), which remains \nunknown prior to calculation. GTs serving as the slack bus in \nEPS and the load node in NGN have known real and imaginary \nvoltage components. However, their unknown power must be \nderived through power flow calculations, while the mass flow \nof consumed gas is solved using the equation (1j) based on their \n\n\nHuang, et al. Dynamic Energy Flow Analysis of Integrated Electricity and Gas Systems: A Semi-Analytical Approach \n4\nactive power. GTs serving as PV buses in EPS and load nodes \nin NGN have known active power and voltage amplitude. The \nmass flow of consumed gas is calculated using the equation (1j) \nbased on their active power, and other unknowns are resolved \nthrough power flow calculations. P2Gs serving as PQ buses in \nEPS and negative load nodes in NGN have known active and \nreactive power. The mass flow of output gas is determined by \nthe equation (1k) based on their active power, with other \nunknowns resolved via power flow calculations. \nC. \nFDM-Based Numerical Algorithm \nThe FDM-based numerical algorithm for the DEF model \nincludes two steps: choosing a difference scheme to discretize \nthe PDEs into AEs and using the iterative method to solve the \nsystem of AEs. In existing work, the commonly-used FDMs for \nthe PDEs of gas flow include the implicit Euler [8] and implicit \ncentral method [21], separately as follows: \n \n,\n1,\n1\n, ,\n1\n,\n1,\n1\n,\n1,\n,\n1,\n1\nj\nj n\nj n\nj\nj n\nj n\nj\nj n\nx\nx\nx\nl\nl\nx\nx\nx\nt\nt\nx\nx\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\n+\n+\n+\n+\n+\n+\n+\n+\nÔÇ∂\n‚àí\nÔÇª\nÔÇ∂\nÔÅÑ\nÔÇ∂\n‚àí\nÔÇª\nÔÇ∂\nÔÅÑ\nÔÇª\n, \n(2a) \n \n(\n)\n,\n1,\n1\n, ,\n1\n,\n1,\n, ,\n,\n1,\n1\n,\n1,\n, ,\n1\n, ,\n,\n1,\n1\n, ,\n1\n,\n1,\n, ,\n2\n2\n1\n4\nj\nj n\nj n\nj n\nj n\nj\nj n\nj n\nj n\nj n\nj\nj n\nj n\nj n\nj n\nx\nx\nx\nx\nx\nl\nl\nx\nx\nx\nx\nx\nt\nt\nx\nx\nx\nx\nx\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\nÔÅ¥\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\nÔÇ∂\n‚àí\n+\n‚àí\nÔÇª\nÔÇ∂\nÔÅÑ\nÔÇ∂\n‚àí\n+\n‚àí\nÔÇª\nÔÇ∂\nÔÅÑ\nÔÇª\n+\n+\n+\n. \n(2b) \nwherein Œîùë° and Œîùëô indicate the temporal and spatial steps, \nrespectively; ùúè= 0,1, ‚ãØ, ùëÅùë°ùëñùëöùëí and ùëõ= 0,1, ‚ãØ, ùëÅùëó\nùë†ùëíùëî are the \nindexes of the temporal and spatial segments, respectively; \nùëÅùë°ùëñùëöùëí is the number of moments to be simulated; ùëÅùëó\nùë†ùëíùëî is the \nnumber of differential segments of pipeline ùëó. \nThe implicit Euler method has 1st order precision with the \ntruncation error ùëÇ(ùõ•ùë°+ ùõ•ùë•). The implicit central method has \n2nd order precision with the truncation error ùëÇ(ùõ•ùë°2 + ùõ•ùë•2), \nwhile it has large oscillations. \nUsing the FDM for (1a) and (1b), we can convert the PDEs \ninto AEs. Then, by combining them with the equations (1c)-(1r), \nwe can get the AEs system for the DEF analysis. Next, we need \nto solve the nonlinear AEs, for which the classical method is \nNewton‚Äôs method.  \nIII. DIFFERENTIAL TRANSFORMATION OF DEF MODEL \nIn this section, we first introduce the principles and rules of \nDT. Second, we propose the semi-discrete method to transform \nthe PDEs of gas dynamics into ordinary differential equations \n(ODEs), based on which the PDAE system of the DEF model \nis converted into nonlinear ODAEs. Finally, we propose the \nDT-based SA approach for the DEF model. \nA. \nIntroduction of Differential Transformation \nThe DT method converts the nonlinear ODAEs to linear AEs. \nThen, the semi-analytical solutions (SASs) are obtained by \ncalculating the DT coefficients of the unknown variables in the \nnonlinear ODAEs [11]. We start from the generic ODAEs, as: \n \n( )\nMx\nf x\n=\n, \n(3a) \nwherein ùë•‚àà‚ÑùùëÅ are the variables; ùëì(ùë•): ‚ÑùùëÅ‚Üí‚ÑùùëÅ are \n(nonlinear) AEs; ùëÄ is the mass matrix. \nIn this paper, for the variable (‚ãÖ), we use (‚ãÖ)\nÃÇ[ùëò] to denote its \nùëòth order DT coefficient. For the equations (3a), the DT \ncoefficients ùë•ÃÇ[ùëò] of the variables ùë• are defined as: \n \nÔÅõÔÅù\n( )\n0\n1\nÀÜ\n0,1,\n,\n!\nk\nk\nt t\nd x t\nx k\nk\nK\nk\ndt\n=\nÔÉ©\nÔÉπ\n=\n=\nÔÉ™\nÔÉ∫\nÔÉ´\nÔÉª\n, \n(3b) \nwherein ùêæ is the selected order of the DT method. \nOnce we obtain the values of ùë•ÃÇ[ùëò], ùëò= 0,1, ‚ãØ, ùêæ, the \napproximated SAS of ùë• can be represented as: \n \n( )\nÔÅõÔÅù(\n)\n0\n0\nÀÜ\nK\nk\nk\nx t\nx k\nt\nt\n=\nÔÇª\nÔÉó\n‚àí\nÔÉ•\n. \n(3c) \nNow, we list the transformation laws used in this paper as \nfollows [10, 11, 13], and interested readers can refer to [11] for \na detailed introduction to DT theory: 1) ùëê‚Üíùëêùõø[ùëò] ‚âú{ùëê, ùëò= 0\n0, ùëò‚â•1, \n2) ùë•(0) ‚Üíùë•ÃÇ[0], 3) ùëêùë•(ùë°) ‚Üíùëêùë•ÃÇ[ùëò], 4) ùë•(ùë°) ¬± ùë¶(ùë°) ‚Üíùë•ÃÇ[ùëò] ¬±\nùë¶ÃÇ[ùëò], 5) ùë•(ùë°) ‚ãÖùë¶(ùë°) ‚Üí‚àë\nùë•ÃÇ[ùëö] ‚ãÖùë¶ÃÇ[ùëò‚àíùëö]\nùëò\nùëö=0\n‚âúùë•ÃÇ[ùëò] ‚äóùë¶ÃÇ[ùëò],  \n6) ( )\nÔÅõÔÅù\n( )\nÔÅõÔÅù\nÔÅõ\nÔÅù\nÔÅõÔÅù\n1\n0\n1\n,\n0\n0\n1\n1\n1\nÀÜ\nÀÜ\nÀÜ\n,\n1\nÀÜ 0\nk\nm\nk\nx\nk\nm\nx k\nm\nx t\nx\nx\nk\nx\n‚àí\n=\nÔÉ¨\n=\nÔÉØ\nÔÉØÔÉØ\n‚Üí\nÔÉ©\nÔÉπ\nÔÉ≠\nÔÉ¶\nÔÉ∂\nÔÉó\n‚àí\nÔÉß\nÔÉ∑\nÔÉ™\nÔÉ∫\nÔÉØ\nÔÉ®\nÔÉ∏\nÔÉ´\nÔÉª\nÔÉØ‚àí\nÔÇ≥\nÔÉØÔÉÆ\nÔÉ•\n, \n7) \n( )\n( )\nÔÅõÔÅù\nÔÅõÔÅù\n1\nÀÜ\nÀÜ\ny t\ny k\nk\nx t\nx\n‚Üí\nÔÉÑ\n, and 8) \n(\n) ÔÅõ\nÔÅù\nÀÜ\n1\n1\ndx\nk\nx k\ndt ‚Üí\n+\n+\n. \nB. \nSemi-Discrete Method of PDE \nObviously, the DT method cannot directly deal with the \nPDEs of gas dynamics. Hence, we propose to use the semi-\ndiscrete method to transform the PDEs into ODEs. \n1) \nSemi-discrete differences \nWe employ the semi-discrete method [22, 23], also called the \nmethod of lines, to transform PDEs into ODEs. Specifically, for \nthe nonlinear PDEs presented in the equations (1a) and (1b), we \ncan reformulate them into a generalized form as follows: \n \n(\n)\n1,2,\n,\npl\npl\nj\nj\npl\nj\nj\nj\nu\nu\n+V\n= Z\nu\nj\nJ\nt\nl\nÔÇ∂\nÔÇ∂\n=\nÔÇ∂\nÔÇ∂\n, \n(4a) \nwherein ùë¢ùëó\nùëùùëô= [ùúãùëó\nùëùùëô   ùëöùëó\nùëùùëô]\n‚ä§; ùëçùëó(ùë¢ùëó) = [0   ‚àíùúÜùëóùëê2ùëöùëó\nùëùùëô|ùëöùëó\nùëùùëô| ‚àï\n(2ùê∑ùëóùëÜùëóùúãùëó\nùëùùëô)]\n‚ä§, and \n \n2\n0\n0\nj\nj\nj\nc\nS\nV\nS\nÔÉ©\nÔÉπ\n= ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ´\nÔÉª\n. \nThen, we keep the time derivative and only discretize the \nspace derivative term using a central difference scheme [24], as: \n \n,\n1\n,\n1\n1,2,\n,\n1\nj n\nj n\nseg\nj\npl\npl\npl\nju\nu\nu\nn\nN\nl\nl\n+\n‚àí\nÔÇ∂\n‚àí\n=\n=\n‚àí\nÔÇ∂\nÔÅÑ\n. \n(4b) \nBy substituting (4b) into (4a), we have \n \n(\n)\n,\n,\n1\n,\n1\n,\n1,2,\n,\n1\npl\npl\np\nj n\nj n\nj n\nseg\nj\nj\nj\nl\np\nn\nj\nl\ndu\nu\nu\nV\nZ\nu\nn\nN\ndt\nl\n+\n‚àí\n‚àí\n=\n+\n=\n‚àí\nÔÅÑ\n. (4c) \nAlso, the initial conditions (1l) and (1m) become \n \n( )\n(\n)\n(\n)\n,\n,\n0,1\n,\n0\n0\n,\ng\npl\npl\ni\nse\nj n\nj\nj\nnit\nj\nu\nn\n= u\nn l\nu\nn l\nN\nÔÅÑ\n=\nÔÅÑ\n=\n. \n(4d) \nRemark 1. For pipeline ùëó comprising ùëÅùëó\nùë†ùëíùëî segments, the \n\n\nSubmitted to IEEE Transactions on Power Systems \n \n5\nequations (4b) encompass a total of 2ùëÅùëó\nùë†ùëíùëî‚àí2  equations. \nHowever, there are 2ùëÅùëó\nùë†ùëíùëî+ 2 variables in these equations. \nEven after accounting for the two boundary conditions at the \nhead and tail of the pipeline, the system remains \nunderdetermined, with fewer equations than unknowns. This \ndiscrepancy arises because the adopted spatial discretization \nscheme utilizes points on both sides to approximate the spatial \npartial derivative of the intermediate point state. To address this \nissue, we propose the numerical boundary conditions. \n2) \nNumerical boundary conditions \nFirst, we perform the eigendecomposition of ùëâùëó in (4a) as \nùëâùëó= ùë£ùëóŒõùëóùë£ùëó\n‚àí1, wherein ùë£ùëó= [ùëêùëÜùëó\n‚ÅÑ\n   ‚àíùëêùëÜùëó\n‚ÅÑ\n; 1   1]. Then, we \nhave \n \n1\n0\n0\nj\nj\nj\nj\nV\nc\nv\nv\nc\n‚àí\nÔÉ©\nÔÉπ\nÔÅå=\n= ÔÉ™\nÔÉ∫\n‚àí\nÔÉ´\nÔÉª\n, \n \nDefine ùë§ùëó\nùëùùëô‚âú[ùë§ùëó\nùëùùëô,1 ùë§ùëó\nùëùùëô,2]\n‚ä§‚âúùë£ùëó\n‚àí1ùë¢ùëó\nùëùùëô= 1 (2ùëê)\n‚ÅÑ\n[ùëÜùëóùúãùëó\nùëùùëô+\nùëêùëöùëó\nùëùùëô   ‚àíùëÜùëóùúãùëó\nùëùùëô+ ùëêùëöùëó\nùëùùëô]‚ä§. Then, from (4a) we have: \n \n(\n)\n1\npl\npl\nj\nj\npl\nj\nj\nj\nj\nj\nw\nw\n+\n= v Z\nv w\nt\nl\n‚àí\nÔÇ∂\nÔÇ∂\nÔÅå\nÔÇ∂\nÔÇ∂\n. \n(4e) \nAccording to the total differential formula, we have \n \npl\npl\npl\nj\nj\nj\ndw\nw\nw\ndl\n+\ndt\nt\nl dt\nÔÇ∂\nÔÇ∂\n= ÔÇ∂\nÔÇ∂\n. \n(4f) \nIf we set the slope of the characteristic line as \n \ndl\nc\ndt = , \nthen the first term of the PDE in (4e) can be converted to ODE \n \n,1\n2\n4\npl\npl\nj\nj\npl\npl\nj\nj\nj\nj\nj\nm\nm\ndw\nc\n=\ndt\nD S\nÔÅ∞\nÔÅ¨\n‚àí\n. \n(4g) \nWe set the spatial step ‚àÜùë•= ùêøùëóùëÅùëó\nùë†ùëíùëî\n‚ÅÑ\n and the temporal step \n‚àÜùë°= ‚àÜùëôùëê\n‚ÅÑ  here, respectively. By Integrating both sides of (4g), \nalong the characteristic line, we have \n \n(\n)\n(\n)\n,1\n,1\n2\n,\n,\n0,1,2,\n4\npl\npl\nj\nj\npl\nj\nj\npl\npl\nj\nj\nj\nj\nt n t\nj\nt\nj\nw\nL t\nn t\nw\nL\nn l t\nm\nm\nc\ndt\nn\nD S\nÔÅ∞\nÔÅ¨\n+ ÔÅÑ\n‚àí\n+ ÔÅÑ\n‚àí\nÔÅÑ\n= ‚àí\n=\nÔÉ≤\n. \n(4h) \nGiven that ùë§ùëó\nùëùùëô,1 is continuous, according to the mean value \ntheorems for integrals, the integral on the right-hand side in (4h) \ncan be expressed as \n \n(\n)\n*\n*\n,\npl\npl\nj\nj\nn\nn\npl\nj\nt\nt n\nt\nm\nm\ndt\nh\nn t\nl t\nÔÅ∞\n+ ÔÅÑ\n=\nÔÉóÔÅÑ\nÔÉ≤\n, \n(4i) \nwherein ùêøùëó‚àíùëõ‚àÜùëô‚â§ùëôùëõ\n‚àó‚â§ùêøùëó; ùë°‚â§ùë°ùëõ\n‚àó‚â§ùë°+ ùëõ‚àÜùë°; ‚Ñé(ùëôùëõ\n‚àó, ùë°ùëõ\n‚àó) ‚âú\nùëöùëó\nùëùùëô(ùëôùëõ\n‚àó, ùë°ùëõ\n‚àó)|ùëöùëó\nùëùùëô(ùëôùëõ\n‚àó, ùë°ùëõ\n‚àó)| ùúãùëó\nùëùùëô(ùëôùëõ\n‚àó, ùë°ùëõ\n‚àó)\n‚ÅÑ\n. \nHence, (4h) can be written as: \n \n(\n)\n(\n)\n(\n)\n2\n,\n*\n1\n,1\n*\n,\n,\n4\n,\nj\npl\npl\nj\nj\nj\nj\nj\nn\nj\nn\nc\nw\nL t\nn t\nw\nL\nl\nt\nn\nt\nt\nh\nn\nD S\nl\nÔÅ¨\n‚àí\n+ ÔÅÑ\n‚àí\nÔÅÑ\n= ‚àí\nÔÉóÔÅÑ. (4j) \nSecond, by using the linear interpolation is considered at \n(ùêøùëó, ùë°+ 2ùêø(ùëêùëÅùëñ\nùë†ùëíùëî)\n‚ÅÑ\n), we have: \n \n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n,1\n,1\n2\n,1\n,\n2\n2\n,\n,\npl\npl\nj\nj\nj\nj\npl\nj\nj\nw\nL t\nt\nw\nL t\nt\nw\nL t\nO\nt\n+ ÔÅÑ\n=\n+ ÔÅÑ\n‚àí\n+\nÔÅÑ\n. \n(4k) \nBased on (4j), we get \n \n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n,1\n,1\n,1\n,1\n2\n*\n*\n*\n2\n2\n1\n*\n1\n,\n2\n2\n2\n,\n,\n,\n,\n,\n2\npl\npl\nj\nj\nj\nj\npl\npl\nj\nj\nj\nj\nj\nj\nj\nw\nL t\nt\nw\nL\nl t\nw\nL t\nt\nw\nL\nl t\nc\nh l\nh l\nt\nt\nD S\nt\nÔÅ¨\n+ ÔÅÑ\n‚àí\nÔÅÑ\n‚àí\n+ ÔÅÑ\n‚àí\nÔÅÑ\n=\n‚àí\n‚àí\n‚àí\n‚àí\nÔÉóÔÅÑ\n. \n(4l) \nTherefore, by combining (4k) and (4l), we have: \n \n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n,1\n,1\n,1\n2\n2\n2\n2\n1\n1\n*\n*\n*\n*\n,\n2\n,\n2\n,\n,\n2\n,\npl\npl\npl\nj\nj\nj\nj\nj\nj\nj\nj\nj\nw\nt\nL\nl t\nw\nL\nl t\nw\nL t\nc\nh l\nh l\nt\nO\nt\nD S\nt\nÔÅ¨\nÔÅÑ\n‚àí\nÔÅÑ\n+\n=\n‚àí\nÔÉóÔÅÑ+\nÔÅÑ\n‚àí\n‚àí\n. \n(4m) \nBy expanding ‚Ñé(ùëô2\n‚àó, ùë°2\n‚àó) in a Taylor series at (ùëô1\n‚àó, ùë°1\n‚àó), we have: \n \n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n2\n2\n1\n1\n2\n1\n2\n*\n*\n*\n*\n*\n*\n*\n1\n*\n,\n,\nh l\nh l\no l\nl\no t\nt\no\nl\no\nt\nt\nt\n‚àí\n‚àí\n+\n=\n‚àí\n=\nÔÅÑ\n+\nÔÅÑ\n. (4n) \nHence, we have: \n \n(\n)\n(\n)\n(\n)\n(\n)\n(\n)\n,1\n,1\n2\n2\n,1\n2\n,\n,\n2\n,\nj\npl\npl\nj\nj\nj\nj\nseg\nj\nj\npl\nj\nj\nseg\nj\nL\nw\nL\nt\nw\nL t\nN\nL\nw\nL\nt\nO\nl\nO\nt\nN\nÔÉ¶\nÔÉ∂\n+\nÔÉß\nÔÉ∑\nÔÉß\nÔÉ∑\nÔÉ®\nÔÉ∏\nÔÉ¶\nÔÉ∂\n=\n‚àí\n+\nÔÅÑ\n+\nÔÅÑ\nÔÉßÔÉß\nÔÉ∑\nÔÉ®\nÔÉ∏\n‚àí\nÔÉ∑\n. \n(4o) \nFinally, we can construct the 2nd order precision numerical \nboundary conditions for ùúãùëó,ùëÅùëó\nùëùùëô at the tail of the pipelines, as: \n \n,\n,\n,\n2\n,\n2\n,\n1\n,\n1\n2\nj\nj\nj\nj\nj\nj\npl\npl\npl\np\nM\nM\nl\npl\npl\nj N\nj\nj\nj\nM\nj\nj\nj\nM\nM\nj\nj\nc\nc\nc\nS\nS\n=\nm\nS\nm\nm\nÔÅ∞\nÔÅ∞\nÔÅ∞\n‚àí\n‚àí\n‚àí\n‚àí\nÔÉ¶\nÔÉ∂\n+\n+\n+\n+\nÔÉß\nÔÉ∑\nÔÉß\nÔÉ∑\nÔÉ®\nÔÉ∏\n. (4p) \nSimilarly, we have the numerical boundary conditions for \nùëöùëó,0\nùëùùëô at the head of the pipeline, as: \n \n,0\n,0\n,2\n,2\n,1\n,1\n2\nj\nj\nj\npl\npl\npl\npl\npl\npl\nj\nj\nj\nj\nj\nj\nm\nc\n=\nc\nS\nS\nm\nm\nc\nS\nÔÅ∞\nÔÅ∞\nÔÅ∞\nÔÉ¶\nÔÉ∂\n‚àí\n+\n‚àí\n‚àí\nÔÉß\nÔÉ∑\nÔÉß\nÔÉ∑\nÔÉ®\nÔÉ∏\n. \n(4q) \nNow, we transform the PDAE system of the DEF model of \nIEGS into the ODAE system, in which the ODEs include (4c) \nand the AEs include (1c)-(1r), (4p) and (4q). In the following, \nwe introduce the DT for the ODAEs models of IEGS.  \nC. \nDT of the DEF Model \n1) \nTransformation of NGN equations \nFor the vector ùëçùëó(ùë¢ùëó,ùëõ\nùëùùëô)  composed of the polynomials of \nvariables, we use ùëçùëó,ùëõ\nùëò to represent the ùëòth order corresponding \nDT coefficient vector of the polynomials. \nFor the pipeline equations (4c), the initial conditions (4d), \nand the numerical boundaries (4p) and (4q), by applying the \ntransformation rules 1) to 8) in Section III-A, we have:  \n \n(\n)\nÔÅõ\nÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n,\n,\n,\n1\n1\n,\nÀÜ\nÀÜ\nÀÜ\n1\n1\n1,2,\n, ,\n1,2,\n,\npl\npl\nj n\nj n\npl\nj n\nseg\nj\nk\nj\nj n\nu\nk\nu\nk\nk\nu\nk\nV\nZ\nl\nj\nJ n\nN\n+\n‚àí\n‚àí\n+\n+\n=\n+\nÔÅÑ\n=\n=\n, \n(5a) \n \nÔÅõÔÅù\n(\n)\n,\n,\nÀÜ\n0\n1 2,\n, ,\n1,2,\n,\npl\ninit\nseg\nj n\nj\nn\nu\n= u\nx\nj\nJ n\nN\n=\n=\n, \n(5b) \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n,\n,\n,\n2\n,\n2\n,\n1\n,\n1\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n2\nj\nj\nj\nj\nj\nj\nM\nM\nM\nM\npl\npl\npl\npl\nj\nj\nj\nj\nM\nj\npl\nj\nj\nM\nj\npl\nj\nm\nm\nm\nm\nc\nc\nk\nk\nk\nk\nS\nS\nc\nk\nS\n=\nk\nÔÅ∞\nÔÅ∞\n‚àí\n‚àí\n‚àí\n‚àí\n+\n+\n+\nÔÉ¶\nÔÉ∂\n+\nÔÉß\nÔÉ∑\nÔÉß\nÔÉ∑\nÔÉ®\nÔÉ∏\n, \n(5c) \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n,0\n,0\n,2\n,2\n,1\n,1\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n2\npl\npl\npl\npl\npl\npl\nj\nj\nj\nj\nj\nj\nj\nj\nj\nS\nm\nm\nc\nc\nc\nk\nk\nk\nk\nk\nm\n=\nk\nS\nS\nÔÅ∞\nÔÅ∞\nÔÅ∞\nÔÉ¶\nÔÉ∂\n‚àí\n+\n‚àí\n‚àí\nÔÉß\nÔÉ∑\nÔÉß\nÔÉ∑\nÔÉ®\nÔÉ∏\n. \n \n \n(5d) \nHere, we use ùêπ1 to denote the pipeline equations in (5a) and \n\n\nHuang, et al. Dynamic Energy Flow Analysis of Integrated Electricity and Gas Systems: A Semi-Analytical Approach \n6\nùêπ2 = {ùêπ2,1, ùêπ2,2}  to denote the equations in (5c) and (5d), \nwherein ùêπ2,1  represents the numerical boundary of the \ncorresponding end of the pipelines that are connected to the \nnodes without the GT serving as the slack bus in EPS, and ùêπ2,2 \nrepresents the numerical boundary of the corresponding end of \nthe pipelines connected to the node, with the GT serving as the \nslack bus in EPS. \nFor the nodal mass flow balance equations (1c), nodal \npressure consistency equations (1d) and (1e), and boundary \nconditions (1o) and (1n), by applying the transformation rules \n3) and 4), we have: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n1\n1,\n,\n1,0\n,0\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nseg\nseg\nJ\nin\nou\nnd\npl\npl\nN\nJ N\np\nt\nl\npl\nJ\nm\nk\nm\nk\nm\nk\nm\nK\nk\n= K\nk\nm\nÔÉ©\nÔÉπ\nÔÉ´\nÔÉª\nÔÉ©\nÔÉπ\n‚àí\nÔÉ´\nÔÉª\n, \n(6a) \n \n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n1\n1,\n,\nÀÜ\nÀÜ\nÀÜ\nseg\nseg\nJ\nnd\npl\ni\npl\nN\nJ\nn\nN\n=\nK\nk\nk\nk\nÔÅ∞\nÔÅ∞\nÔÅ∞\nÔÉ©\nÔÉπ\nÔÉ´\nÔÉª, \n(6b) \n \n(\n)\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n1,0\n,0\nÀÜ\nÀÜ\nÀÜ\ndiag\nnd\nl\ncmp\nout\npl\np\nJ\nK\n=\nK\nk\nk\nk\nÔÅ∞\nÔÅ∞\nÔÅ∞\nÔÉ©\nÔÉπ\nÔÉ´\nÔÉª, \n(6c) \n \nÔÅõÔÅù\nÔÅõÔÅù\nÀÜ\nÀÜ\nload\na\nn\nnd\nlo d\n=\nk\nn\nm\nS\nk\nm\nÔÄ¢ÔÉé\n, \n(6d) \n \nÔÅõÔÅù\nÔÅõÔÅù\nÀÜ\nÀÜ\nsrc\nr\nn\nnd\ns c\nk =\nn\nS\nk\nÔÅ∞\nÔÅ∞\nÔÄ¢ÔÉé\n. \n(6e) \nHere, we use ùêπ3 = {ùêπ3,1, ùêπ3,2} to denote the equations in (6a)\n-(6e), wherein ùêπ3,1 represents the nodal equations at the nodes \nwithout the GT serving as the slack bus in EPS, ùêπ3,2 represents \nthe nodal equations at the node with the GT serving as the slack \nbus in EPS. \n2) \nTransformation of EPS equations \nBy applying the transformation rules 3) to 5), the power flow \nequations (1f) to (1h) can be transformed as: \n \nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÀÜ\nÀÜ\nÀÜ\nÀÜ\ndiag\nÀÜ\nÀÜ\nÀÜ\ndiag\np k\ne k\nGe k\nBf k\nf k\nBe k\nGf k\n=\nÔÉÑ\n‚àí\n+\nÔÉÑ\n+\n, \n(7a) \n \nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÀÜ\nÀÜ\nÀÜ\nÀÜ\ndiag\nÀÜ\nÀÜ\nÀÜ\n-diag\nq k\nf k\nGe k\nBf k\ne k\nBe k\nGf k\n=\nÔÉÑ\n‚àí\nÔÉÑ\n+\n, \n(7b) \n \nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÀÜ\nÀÜ\nÀÜ\nÀÜ\ndiag\n+diag\nÀÜ\nÀÜ\n=diag\ne k\ne k\nf k\nf k\nU k\nU k\nÔÉÑ\nÔÉÑ\nÔÉÑ\n. \n(7c) \nHere, we use ùêπ4 to represent the equations (7a)-(7c). \nBy applying transformation rule 3), the boundary conditions \nùëù, ùëû and ùëà become ùëùÃÇ[ùëò], ùëûÃÇ[ùëò] and ùëàÃÇ[ùëò], as: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n,\nPV\nPV\nPV\nb\nb\np k = p\nk U k =U\nk\nb\nS\nÔÄ¢ÔÉé\n, \n(7d) \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n,\nPQ\nb\nPQ\nPQ\nbp k = p\nk\nq k = q\nk\nb\nS\nÔÄ¢ÔÉé\n, \n(7e) \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n,\nslk\nslk\nslk\nb\nb\ne k = e\nk\nf k = f\nk\nb\nS\nÔÄ¢ÔÉé\n. \n(7f) \n3) \nTransformation of coupling components equations \nBy applying the transformation rule 3), the coupling \ncomponents equations (1i), (1j), and (1k) becomes: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n1,0\n,0\n,\n,\nÀÜ\nÀÜ\nÀÜ\nÀÜ\ntan\nÀÜ\nC\np\nb\nout\ni\nl\npl\nb\nC\nb i\nb\nJ\nb\np k\nm\nk\nm\nk\nk\np k\nK\nK\nS\ni b\nq\nÔÅ±\nÔÉ©\nÔÉπ\n= ‚àí\nÔÉ´\nÔÉª\n=\nÔÄ¢\nÔÉé\n, \n(8a) \n \nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\n,\nÀÜ\nÀÜ\n,\nGFU\nGT\nnd\nb\nb i\ni\np k\nm\nk\n=\nK\nS\ni b\n‚àí\nÔÄ¢\nÔÉé\n, \n(8b) \n \nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n2\n2\n,\n,\nÀÜ\nÀÜ\nt\nÀÜ\nÀÜ\nan\nP\nb\nnd\nP\nb\nG\ni\nG\nb i\nb\nb\nm\nk\np k\nk\np k\n=\nK\nS\ni b\nq\nÔÅ±\n‚àí\nÔÄ¢\n=\nÔÉé\n. \n(8c) \nHere, we use ùêπ5 = {ùêπ5,1, ùêπ5,2}  to represent the coupling \ncomponents equations (8a)-(8c), wherein ùêπ5,1  represents the \nequations of the GTs serving as the PV buses in EPS and the \nP2Gs, and ùêπ5,2 represents the equations of the electricity-driven \ncompressors and the GT serving as the slack bus in EPS. \nRemark 2. Now, the original DEF model of IEGS, (1a)-(1r), \nis transformed into ùëò-domain system, as given in (5a)-(8c). It \ncan be found that the ùëò-domain system defines the linear \nrecursive equations of ùëòth order DT coefficients, i.e., the ùëòth \norder DT coefficients can be obtained by solving a linear system \nonce the 0th order to (ùëò‚àí1)th order DT coefficients are known. \nTherefore, through the DT-based SA algorithm, once the order \nùêæ is selected, we can obtain the values of the ùëòth order DT \ncoefficients from ùëò= 1 to ùëò= ùêæ sequentially by solving the \nlinear equations, and then get the time-domain analytical \nsolutions of unknows based on (3c). \nRemark 3. Note that, if the semi-discrete difference scheme \n(4b) becomes ùúïùë¢ùëó\nùëùùëôùúïùë•\n‚ÅÑ\n= (ùë¢ùëó,ùëõ\nùëùùëô‚àíùë¢ùëó,ùëõ‚àí1\nùëùùëô\n) Œîùë•\n‚ÅÑ\n, the number of \nequations equals the number of unknown variables. However, \nDT of the ODE (4c) in NGN will decouple the pressure and \nmass flow of the gas in these equations, where the only variable \nin each equation is pressure or mass flow, resulting in the \nsingularity of the coefficient matrix of the equation after DT in \nNGN with loop network. \nIV. SEMI-ANALYTIC SIMULATION ALGORITHM \nIn this section, we introduce the SA simulation algorithm \ntailored for the DEF model. First, we reveal the inherent block \nstructure within the linear equations of the DT coefficients. \nSecond, we derive a non-iterative solution method based on the \nblock characteristics. Finally, we propose an adaptive time \nwindow control technique to adjust the DT time window by \nestimating the truncation error of the solution. \nA. \nBlock Structure of DT Coefficient Equations \nFirst, we define some new symbols to denote the DT \ncoefficients as: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\n1\n,\n2\n1\n1,\n,\n,\n0\nÀÜ\n  \n ?\nÀÜ\nÀÜ\nJ\nse\nj\nseg\nj\nj\ng\nN\npl\npl\npl\nj\nJ\nj\nj N\nu\nk\nu\nk\nu\nk\n=\n+\n=\nÔÉ•\nÔÉ©\nÔÉπ\nÔÉé\nÔÉ™\nÔÉ∫\nÔÉ´\nÔÉª\n, \n \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n2\n1,\n,\nÀÜ\nÀÜ\nÀÜ\nnd\nnd\nnd\nI\ni\ni\ni\nI\nu\nk\nk\nm\nk\nÔÅ∞\n=\nÔÉ©\nÔÉπ\nÔÉé\nÔÉ´\nÔÉª\n. \n \nWe denote ùëùùëêùëù as the unknown injection active power of the \nbuses where the GT serving as the slack bus in EPS and the \nelectricity-driven compressors are located. Also, for variables \n(‚ãÖ), we define (‚ãÖ)[0: ùëò] ‚âú[(‚ãÖ)[0]   (‚ãÖ)[1] ‚ãØ (‚ãÖ)[ùëò]]\n‚ä§.  \nThen, we split ùë¢ÃÇùëùùëô[ùëò] into three parts, denoted as ùë¢ÃÇùëùùëô,1[ùëò], \nùë¢ÃÇùëùùëô,2[ùëò] , and ùë¢ÃÇùëùùëô,3[ùëò] , wherein ùë¢ùëùùëô,1  denotes the DT \ncoefficients of the states inside the pipelines, i.e., ùë¢ÃÇùëùùëô,1[ùëò] =\n[ùë¢ÃÇùëó,1\nùëùùëô[ùëò]   ùë¢ÃÇùëó,2\nùëùùëô[ùëò] ‚ãØ ùë¢ÃÇùëó,ùëÅùëó\nùë†ùëíùëî‚àí1\nùëùùëô\n[ùëò]]\nùëó=1,2,‚ãØ,ùêΩ\n‚ä§\n; ùë¢ÃÇùëùùëô,2[ùëò] denotes the \nDT coefficients of the states at the corresponding end of the \npipelines which are connected to the node without the GT \nserving as the slack bus in EPS; ùë¢ùëùùëô,3  denotes the DT \ncoefficients of the states at the corresponding end of the \npipelines connected to the node, with the GT serving as the \n\n\nSubmitted to IEEE Transactions on Power Systems \n \n7\nslack bus in EPS. \nThe equations in IEGS (5a)-(8c) can be written in matrix \nform as given in (9a), wherein ùëè1\nùëò, ùëè2\nùëò, and ùëè3\nùëò are vectors whose \nvalues are all known. We calculate the DT coefficient order by \norder through recursion without solving the equation iteratively.\n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n,1\n,\n2\n1\n,2\n,2\n,1\n,1\n,1\n,3\n1\n2,1\n2,1\n3,1\n3,1\n5,1\n,2\n2,2\n3,2\n3,2\n4\n4\n4\n5,2\n5,2\n,3\n,2\n,2\n,2\n,2\n5\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\npl\npl\npl\npl\nnd\nnd\npl\npl\npl\nnd\npl\nn\np\nd\nc\ncp\nu\nk\nu\nk\nu\nk\nu\nF\nk\nu\nk\nu\nk\nu\nk\nu\nF\nF\nF\nF\nF\nF\nF\nF\nF\nF\nF\nF\np\nf\nk\nk\nu\nk\nu\ne k\nk\nk\nu\nk\nF\nF\nF\np\nu\nk\nk\nÔÇ∂\nÔÉ©\nÔÉ™ÔÇ∂\nÔÉ™\nÔÉ™\nÔÇ∂\nÔÇ∂\nÔÉ™ÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ™\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ™\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÇ∂\nÔÉ™\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÉ´\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõ\nÔÅù\n(\n)\nÔÅõÔÅù\nÔÅõÔÅù\n(\n)\n3\n,1\n,2\n,1\n,\n1\n3\n2\n,2\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n0:\nÀÜ\nÀÜ\n,\nÀÜ\nÀÜ\n1\nÀÜ\nÀÜ\nÀÜ\nk\nk\nsrc\nlo\npl\npl\nnd\npl\npl\nnd\nad\ncp\nu\nk\nu\nk\nu\nk\nu\nk\nu\nk\nk\nk\nu\nk\ne k\nk\nk\nb\nb\nm\nb\nf\np\nÔÅ∞\nÔÉ©\nÔÉπ\nÔÉπ\nÔÉ™\nÔÉ∫\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫ÔÉ©\nÔÉπ\nÔÉ™\nÔÉ∫\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\n=\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ´\nÔÉª\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉª\n‚àí\nÔÉ∫\nÔÉ´\nÔÉª\nÔÅõ\nÔÅù\nÔÅõ\nÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõ\nÔÅù\nÔÅõÔÅù\n(\n)\n,2\n1,\n,\nÀÜ\nÀÜ\n,\nÀÜ\nÀÜ\n,\n,\n,\nÀÜ\nÀÜ\n1:\n1\n1:\n,\n1\n0:\n,\nk\npl\nk\nK\nf\np\nq\nU\ne\nk\nk\nk\nk\nk u\nk\nÔÉ©\nÔÉπ\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÄ¢=\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\n‚àí\nÔÉ´\nÔÉª\n‚àí\n \n(9a)\nLet us simplify (9a) in the following form: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n1\n1\n11\n21\n22\n2\n2\n31\n32\n33\n3\n3\nÀÜ\nÀÜ\n1,\n,\nÀÜ\n,\nk\nk\nk\nk\nk\nx k\nb\nW\nW\nW\nx\nk\nb\nk\nK\nW\nW\nW\nb\nx k\nÔÉ©\nÔÉπ\nÔÉ©\nÔÉπ\nÔÉ©\nÔÉπÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÄ¢=\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÉ´\nÔÉªÔÉ™\nÔÉ∫\nÔÉ´\nÔÉª\nÔÉ´\n=\nÔÉª\n0\n0\n0\n, \n(9b) \nwherein ùë•ÃÇ1[ùëò], ùë•ÃÇ2[ùëò], and ùë•ÃÇ3[ùëò] represent the DT coefficients \nrequired to solve in the corresponding three steps. \n1) \nStep 1: Get the internal state of the pipeline recursively \nAccording to the equation (5a), when calculating the \ninternal state variables of the pipeline in step 1, ùë•ÃÇ1[ùëò]  is \ncalculated by the recursive relation ùëî1\nùëò, as: \n \nÔÅõÔÅù\nÔÅõ\nÔÅù\n(\n)\n1\n1\n:\nÀÜ\nÀÜ\n0\n1 ,\n1,\n,\nk\npl\nx\nK\nk\nu\nk\nk\ng\n=\n=\n‚àí\nÔÄ¢\n. \n(9c) \nwherein the relation ùëî1\nùëò is determined by the pipeline \nparameters and varies according to the order ùëò. The \nindependent variables of the recurrence relation are the lower \norder DT coefficients of the pipeline state. Then we write it in \nmatrix form, as: \n \nÔÅõÔÅù\nÔÅõ\nÔÅù\n(\n)\n11 1\n1\nÀÜ\n0:\n1\nÀÜ\np\nk\nk\nl\nW\nu\nx k\nb\nk ‚àí\n=\n, \n(9d) \nwherein ùëä11\nùëò is a diagonal matrix. \n2) \nStep 2: Obtain the state of uncoupled nodes and pipeline \nIn step 2, the nodal equations ùêπ2,1, ùêπ3,1 and ùêπ5,1 for nodes \nwithout the GT serving as the slack bus in EPS can be written \nas: \n \nÔÅõÔÅù\nÔÅõÔÅù\n21 1\n22\n2\n2\nÀÜ\nÀÜ\nk\nW x k\nW x k\nb\n+\n=\n, \n(9e) \nwherein ùë•ÃÇ1[ùëò] is already solved in step 1. We consider the \ncoefficient matrix ùëä22  for ùë•ÃÇ2[ùëò]  here. To simplify the \ncalculation, only one of the nodes, ùëñ, is considered here. \nConsidering that the pressures are equal at the nodes, we first \nuse ùúãÃÇùëñ\nùëõùëë,1[ùëò] to eliminate all unknown ùúãÃÇ ùëùùëô[ùëò] in the equation, \nas: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n2\n2,\n2\n,\n,\n11\n,2\n,\n22\n,1\n,1\n1,\n1,\n43\n44\n,\nÀÜ\nÀÜ\n1\n,\nÀÜ\n1\nÀÜ\nÀÜ\n,\npl\nout i\npl\nin i\nnd\ni\nnd\ni\nk\ni\ni\ni\nm\nk\nV\nK\nb\nm\nk\nk\nV\nk\nV\nV\nW\nm\nk\nx\nk\nÔÅ∞\nÔÉ©\nÔÉπ\nÔÉ©\nÔÉπÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\n‚àí\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ´\n‚àí\nÔÄ¢\nÔÉ∫\nÔÉªÔÉ´\nÔÉª\n=\n=\n1\n1\n1\n1\n, \n(9f) \nwherein ùëâ11 is a diagonal matrix whose elements are ‚àíùëêùëÜùëúùëñ\n‚ÅÑ\n; \nùëâ22 is a diagonal matrix with elements ùëêùëÜùëñùëñ\n‚ÅÑ\n; ùëúùëñ and ùëñùëñ denote \nthe labels for all outgoing and incoming pipelines connected to \nnode ùëñ, respectively; ùëöÃÇùëúùë¢ùë°,ùëñ\nùëùùëô,2 [ùëò] and ùëöÃÇùëñùëõ,ùëñ\nùëùùëô,2[ùëò] are the unknown \nvectors of the DT coefficients about the mass flow at the head \nor tail of all outgoing and incoming pipelines connected to \nnode ùëñ, respectively; the value of one for ùëâ43 or ùëâ44 indicates \nthat the node serves as a source or load node. \nIf the node has the GT serving as a PV bus in EPS or P2G, \nand its active power is known, its coupling components \nequations (8b) and (8c) are in the same form as the boundary \nconditions of NGN, which can also be written as the fourth row \nin the matrix ùëä22. Then, we show that ùëä22 is of full rank. We \nuse the first and second rows in the matrix ùëä22 to eliminate the \nfirst two row vectors in the left hand of the third row so that \nthe newly formed ùëâ33  is non-zero. Therefore, whether this \nnode is a source node or a load node, the coefficient matrix \nùëä22 is full rank. \nIn addition, we find that ùëä22  is only related to the \nparameters given in NGN, and there is no need to update \nduring simulation. \n3) \nStep 3: Calculate the states of coupling nodes and EPS \nby non-iterative method \nNext, the equations ùêπ2,2, ùêπ3,2, ùêπ4 and ùêπ5,2 for EPS and the \nnode with the GT serving as the slack bus in EPS can be written \nas: \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n31 1\n32\n2\n33\n3\n3\nÀÜ\nÀÜ\nÀÜ\nk\nk\nW x k\nW x k\nW x k\nb\n+\n+\n=\n \n(9g) \nwhere ùë•ÃÇ1[ùëò] and ùë•ÃÇ2[ùëò] is already solved in the previous steps. \nWe consider the coefficient matrix ùëä33\nùëò for ùë•ÃÇ3[ùëò] here. \n \nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\nÔÅõÔÅù\n2\n,3\n,3\n,\n2,2\n3,2\n3,2\n4\n4\n2\n4\n5,2\n5,\n3\n3\n2\n1 1\n,3\n,\n,\n32\n2\n2\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n,\nÀÜ\nÀÜ\nÀÜ\nÀÜ\n1,\n,\no\npl\npl\nnd\npl\nd\nC u\nd\ncp\nCou\nn\nk\nn\nu\nk\nu\nk\nu\nk\nu\nk\nu\nk\ne k\nf\nK\nk\nx\ne k\nf\nf\nf\nf\nf\nf\np\np\nf\nf\np\nb\nk\nf k\nk\nu\nk\nk\nW\nk\nW x\nk\nk\nÔÇ∂\nÔÉ©\nÔÉπ\nÔÉ™\nÔÉ∫\nÔÇ∂\nÔÉ™\nÔÉ∫ÔÉ©\nÔÉπ\nÔÉ™\nÔÉ∫\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÇ∂\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫ÔÉ™\nÔÉ∫\nÔÉ´\nÔÉª\nÔÇ∂\nÔÇ∂\nÔÉ™\nÔÉ∫\nÔÉ™\nÔÉ∫\nÔÇ∂\nÔÇ∂\nÔÉ´\nÔÉª\n‚àí\n‚àí\nÔÄ¢=\n=\n \n(9h) \n\n\nHuang, et al. Dynamic Energy Flow Analysis of Integrated Electricity and Gas Systems: A Semi-Analytical Approach \n8\nThe first two rows and the last row of ùëä33\nùëò are similar to \nthose of ùëä22, except that the original boundary conditions are \nchanged into the coupling equations. For the GT serving as the \nslack bus in EPS, its mass flow is calculated by the injected \npower of the bus. For electricity-driven compressors, the \ninjected power of the corresponding bus is calculated from the \npreviously calculated mass flow through the compressor by \n(8a). The third row of ùëä33\nùëò represents the power flow equations \nof EPS. As described in the review, in step 3, the EPS \nequations and NGN nodal equations with the GT serving as the \nslack bus in EPS are integrated through the coupling \ncomponents equations. We increase the equations about the \nactive power flow of the slack bus and the energy flow \nconversion equations of the electricity-driven compressors by \nthe same amount as the number of unknowns for the injected \nactive power of the slack bus and buses with electricity-driven \ncompressors. \nFurthermore, in this step, we find that ùëä33 is related to the \n0th DT coefficient about EPS, independent of the order ùëò, and \nonly needs to be updated once in each time window. \nBased on the above matrix partition, we use the non-iterative \ntechnique to solve the problem according to the characteristics \nof IEGS and DT. The simulation process of IEGS DEF by DT \nmethod is shown in Algorithm 1. \nB. \nAdaptive Time Window Control Technique \nTo compute the 0th order DT coefficient for the subsequent \ntime window, we employ the adaptive window control \ntechnique [15], which is an evolution of the stepsize control \nstrategy utilized in the Runge-Kutta method [25]. This \ntechnique dynamically adjusts the time window for each \ncalculation based on the error tolerance we set, thereby \nmitigating the risk of result divergence during significant \nsystem state changes and enhancing simulation robustness. \nAlgorithm 2 outlines the procedure for implementing the \nadaptive time window control technique. Initially, we estimate \nthe truncation error ùë¶ÃÉ of the (ùêæ‚àí1)th order DT coefficient \nusing the ùêæth DT coefficients obtained. Subsequently, we \ndetermine the error tolerance ùúÄ by considering the absolute \ntolerance Atol, relative tolerance Rtol, and the variable values \nwithin the time window. The root mean square error ùëíùëüùëü is \nthen calculated using ùë¶ÃÉ and ùúÄ, and the size of the time window \nis adjusted under the constraint of the change rate. Wherein \nùëìùëéùëê represents a conservative factor less than one; ùëìùëéùëêùëöùëéùë• \nand ùëìùëéùëêùëöùëñùëõ serve as upper and lower bounds to prevent abrupt \nchanges in temporal steps; ùë¶ÃÇ[ùêæ] denotes the vector containing \nall ùëÅ DT coefficients of the ùêæth order. \nRemark 4. When calculating the DT coefficients of each \norder for the states between nodes in NGN during step 2, we \nobserve that these coefficients are decoupled by the pipeline \nand do not mutually influence each other. This decoupling \narises because the DT coefficients of the internal state of the \npipeline have already been computed in step 1, thus preventing \nthe nodes from interacting through the pipeline. However, it is \nimportant to note that this decoupling is specific to the \ncalculation of a particular order of the DT coefficient. The \nchanges in the node state variables remain coupled within the \ntime window. This coupling occurs because the computation \nof subsequent order DT coefficients involves the DT \ncoefficient of the internal state of the pipeline, which is \ninfluenced by the DT coefficient at the boundary of pipelines, \nwhich in turn is related to the node state. \nV. CASE STUDIES \nIn this section, the proposed non-iterative method is tested \non two systems: 1) a 50 km single gas pipeline; 2) a 133-node-\n118-bus system. For comparative analysis, the following \nmethods are employed: 1) M1: Characteristic line method \nsolved using Newton‚Äôs method, serving as the benchmark for \naccuracy analysis; 2) M2: Implicit Euler difference scheme \nsolved using Newton‚Äôs method; M3: Implicit central \ndifference scheme solved using Newton‚Äôs method; M4: DT \nmethod with 5th order.  \nIn the first system, we demonstrate the superior accuracy of \nthe proposed method compared to the numerical methods. In \nthe second system, we validate the increased computational \nefficiency of the proposed method over the numerical methods. \nAll tests are conducted using Python 3.11.9 on a computer with \nan Intel i9-13900K CPU and 96 GB of RAM. \n\n\nSubmitted to IEEE Transactions on Power Systems \n \n9\nA. \nA 50km Single Gas Pipeline System \nThe single gas pipeline system comprises a pipeline linking \nthe source and load nodes [3]. The source node pressure is \nfixed at 300 kPa, whereas the load mass flow varies: it \ndecreases from 1.2 kg/s to 0.8 kg/s when time reaches 0.5 \nhours, then increases to 2 kg/s at 1.5 hours, and decreases \ngradually after 2 hours.  \nThe results obtained from M1 are utilized as reference data \nto assess the accuracy of M2-M4. A uniform spatial step of 1 \nkm is adopted for all simulations. For M2 and M3, the tests are \nperformed at temporal steps of 180 seconds and 9 seconds. The \nadaptive time window control technique is employed in M4 to \nensure that the temporal step yields the results within the \nacceptable error tolerance, thereby enhancing the robustness of \nthe proposed method against significant disturbances. \nAs we can see from Fig. 2, the results obtained by M2 and \nM3 with a small temporal step and M4 are close to the \nreference data generated by M1, indicating the high accuracy \nachieved by these methods. In contrast, M2 and M3 with a \nlarger temporal step exhibit a more significant error. Table I \npresents    h m th  ‚Äôs    t m    sq          s (RM Es) \ncompared to the reference data to quantify the accuracy \ndifferences. This quantitative assessment yields a notable \nobservation: Numerical methods require considerably smaller \ntemporal steps to attain accuracy levels comparable to M4. \nAlthough refining the temporal discretization enhances \naccuracy, it substantially increases computational costs and \nexecution time, rendering it challenging for real-time \napplications or large-scale simulations. Consequently, M4 \nstands out as an effective and practical choice for addressing \ncomplex integrated energy network problems, owing to its \ninherent ability to maintain high accuracy. \nB. \nA 133-node & 118-bus System \nThe effectiveness and efficiency of the proposed method are \nvalidated in a large-scale system, which is an improved system \nof the 133-node NGN and IEEE 118-bus EPS from [26, 27]. \nThe coupling components in the system consist of 5 GTs, a \nP2G, and an electricity-driven compressor. Specifically, the \nGT serving as the slack bus at bus 69 in EPS is supported by \nNGN at node 89. The remaining 4 GTs, serving as PV buses at \nbuses 10, 12, 49, and 61 in EPS, are supported by NGN at \nnodes 133, 130, 90, and 98, respectively. The P2G at node 79 \nin NGN is supplied by EPS at bus 59, and the electricity-driven \ncompressor at node 84 in NGN is powered by EPS at bus 114. \nUtilizing the results obtained from M1 with a spatial step of \n500 m as a baseline, the calculation accuracy and speed of \nmethods M2-M4 are evaluated under the same spatial step of \n1000 m.  \nAs shown in Fig. 3, M2-M4 effectively capture the dynamic \nchanges in mass flow and pressure in NGN, and voltage \n(a) \n(b) \nFig. 2. Accuracy comparison on a single pipeline system: (a) ùëöùëñùëõ; (b) ùúãùëúùë¢ùë°. \nTABLE I \nRMSES AGAINST REREFENCE DATA \nVariable \nM2-180s \nM2-9s \nM3-180s \nM3-9s \nM4 \nùëö0 \n2.70e-3 \n1.48e-4 \n2.78e-3 \n2.18e-4 \n1.66e-5 \nùëùùëÅ \n6.26e1 \n1.01 \n8.83e1 \n6.90e-1 \n1.76 \n(a) \n(b) \n(c) \n(d) \nFig. 3. Accuracy comparison on a 133-node-118-bus system: (a) ùëö0\nùëùùëô and \nùëö101\nùëùùëô; (b) ùúã88\nùëõùëë and ùúã83\nùëõùëë; (c) ùëà58 and ùëà113; (d) ùúÉ58 and ùúÉ113. \n\n\nHuang, et al. Dynamic Energy Flow Analysis of Integrated Electricity and Gas Systems: A Semi-Analytical Approach \n10 \ndistribution in EPS. Particularly for the mass flow and pressure \nstates in NGN, the results of M2 and M3 with smaller temporal \nsteps and M4 exhibit good agreement with the reference results. \nHowever, M2 and M3 with a large temporal step deviate \nsubstantially when the system boundary changes significantly. \nWe can find from Table II that the calculation accuracy of M4 \nin EPS is comparable to that of M2 and M3. Notably, the \naccuracy of M4 in NGN surpasses that of M2 and M3 with \nsimilar temporal steps. Furthermore, despite M3 with 2nd \norder precision in the difference scheme, numerical \noscillations occur during the simulation process, leading to \nlower mass flow calculation accuracy than M2 with 1st order \nprecision. \nAs presented in Table III, a comparative analysis of the \ncomputational cost among multiple methods reveals further \nadvantages of M4 over numerical methods such as M2 and M3. \nThe advantage of M4 lies in its utilization of recursive \ncalculations and linear equation solving, eliminating the \nrequirement for iterative solutions. As a result, when using \ncomparable temporal steps, M2 and M3 demonstrate longer \ntotal calculation times than the proposed M4. Previous \nfindings show that M2 and M3 require considerably smaller \ntemporal steps to achieve an accuracy level comparable to M4. \nFurthermore, it is well-established that, for the given method, \ncalculation time is directly proportional to the number of \ncalculation steps and inversely proportional to the size of the \ntemporal step. This relationship further confirms the superior \ncomputational efficiency of the proposed M4 method.  \nVI. CONCLUSION \nIn this paper, we have addressed the challenges associated \nwith DEF simulation in IEGS by proposing a novel non-\niterative SA method based on DT. Our method achieves high \naccuracy with a small computational cost by leveraging the \nrecursive properties of DT. Simulation results demonstrate the \neffectiveness and superiority of the proposed approach. \nREFERENCES \n[1] J. Wu, J. Yan et al., ‚ÄúI t g  t   E   gy  yst ms,‚Äù Applied Energy, vol. \n167, pp. 155-157, 2016. \n[2] E. A. Martinez Cesena, E. Loukarakis et al., ‚ÄúI t g  t   E   t    ty‚Äì \nHeat‚ÄìGas Systems: Techno‚ÄìEconomic Modeling, Optimization, and \nA      t    t  M  t     gy D st   ts,‚Äù Proceedings of the IEEE, vol. 108, \nno. 9, pp. 1392-1410, 2020. \n[3] J. Fang, Q. Zeng et al., ‚ÄúDy  m   O t m   E   gy F  w    th  I t g  t   \n  t     G s     E   t        w    yst ms,‚Äù IEEE Transactions on \nSustainable Energy, vol. 9, no. 1, pp. 188-198, Jan, 2018. \n[4] T. K   h , ‚ÄúA   m     t m th   f   t   s   t g s f  ws           tw  ks,‚Äù \nInternational Journal of Heat and Fluid Flow, vol. 15, no. 5, pp. 378-383, \n1994. \n[5] J. Zh  , X. Zh  ,     Y.   , ‚ÄúA   ys s  f   t     g s f  w   v  s      \n  t g  t       gy syst m b s       y  m   s m   t   ,‚Äù Energy Reports, \nvol. 7, pp. 1149-1158, 2021. \n[6] A. Shabanpour-H gh gh ,     A. R.    f , ‚ÄúA  I t g  t    t   y-State \nOperation Assessment of Electrical, Natural Gas, and District Heating \n  tw  ks,‚Äù IEEE Transactions on Power Systems, vol. 31, no. 5, pp. \n3636-3647, 2016. \n[7]  . Ch v     ,     D. W , ‚ÄúDy  m          k      t    m    s f     t     \ng s            tw  ks,‚Äù Applied Mathematical Modelling, vol. 94, pp. \n169-186, 2021. \n[8] J. Yang, N. Zhang et al., ‚ÄúEff  t  f   t     G s F  w Dy  m  s    R b st \nG     t      h      g U     W    U    t   ty,‚Äù IEEE Transactions on \nPower Systems, vol. 33, no. 2, pp. 2087-2097, 2018. \n[9] C. Kelley, Solving Nonlinear Equations with Newton‚Äôs Method: SIAM, \n2003. \n[10] I. H. Abdel-H   m H ss  , ‚ÄúA      t    t    ff    t    t   sf  m t    \nm th   f   s  v  g syst ms  f   ff    t     q  t   s,‚Äù Applied \nMathematical Modelling, vol. 32, no. 12, pp. 2552-2559, 2008. \n[11] G. G. Ev   kh v, ‚ÄúD ff    t    t   sf  ms           t th   y,‚Äù \nInternational Journal of Circuit Theory and Applications, vol. 10, no. 3, \npp. 265-276, 2006. \n[12] C. B  v      , ‚Äú t t s  f th    ff    t    t   sf  m t    m th  ,‚Äù Applied \nMathematics and Computation, vol. 218, no. 20, pp. 10158-10170, 2012. \n[13] Y.    , K.    ,     J. D  g, ‚ÄúA Dy  m z     w   F  w M th   B s   \n   D ff    t    T   sf  m t   ,‚Äù IEEE Access, vol. 8, pp. 182441-\n182450, 2020. \n[14] Y. Liu, K. Sun et al., ‚Äú  w    yst m T m  D m      m   t    Us  g   \nD ff    t    T   sf  m t    M th  ,‚Äù IEEE Transactions on Power \nSystems, vol. 34, no. 5, pp. 3739-3748, 2019. \n[15] R. Yu, W. Gu et al., ‚Äú   -Iterative Calculation of Quasi-Dynamic \nE   gy F  w    th  H  t     E   t    ty I t g  t   E   gy  yst ms,‚Äù \nIEEE Transactions on Power Systems, vol. 38, no. 5, pp. 4148-4164, \n2023. \n[16] T. Zhang, Z. Li et al., ‚ÄúDy  m       gy f  w     ys s  f   t g  t   g s \n        t    ty syst ms  s  g th  h   m   h    mb     g m th  ,‚Äù \nApplied Energy, vol. 309, 2022. \n[17] X. Huang, H. Tian et al., ‚ÄúD g t   tw  s  f m  t         gy   tw  ks \nbased on real-time simulation using holomorphic embedding method, \nPart I: Mechanism-   v   m      g,‚Äù International Journal of Electrical \nPower & Energy Systems, vol. 154, 2023. \n[18] A. E. F   h m,     M. H. G   w t  , ‚Äú  m   t    m    s f   g s \nt   sm ss      tw  ks,‚Äù Transactions of the Institute of Measurement \nand Control, vol. 1, no. 1, pp. 3-13, 1979. \n[19] Z. Bao, Q. Zhang et al., ‚ÄúC s     g F            g t      m   t       \nI t g  t   E   t    ty       t     G s  yst ms,‚Äù Journal of Modern \nPower Systems and Clean Energy, vol. 8, no. 5, pp. 961-970, 2020. \n[20] H. Ma, C. Liu et al., ‚ÄúA   v       yt        f        gy f  w        t    \nm th   f     t g  t       gy syst ms b s      h   m   h    mb     g,‚Äù \nApplied Energy, vol. 344, 2023. \n[21] A. G     y,     J.  . M    s, ‚ÄúF   t    ff       m th  s f             \nhy   b     syst ms,‚Äù Mathematics of Computation, vol. 22, no. 101, pp. \n28-39, 1968. \n[22] N. Mostoufi, and A. Constantinides, ‚ÄúPartial differential equations,‚Äù \nApplied Numerical Methods for Chemical Engineers, pp. 327-401, 2023. \n[23] E. T  t s, D. M  g   s,     D.       k s, ‚ÄúT   s   t g s f  w s m   t    \n s  g    A   t v  M th    f     s,‚Äù Comptes Rendus. M√©canique, vol. \n331, no. 7, pp. 481-487, 2003. \n[24] G. G  ff ths, W.   h  ss  ,      . H m  , ‚ÄúM th    f     s,‚Äù \nScholarpedia, vol. 2, no. 7, 2007. \n[25] K. G st fss  , M.     h,     G.  √∂       , ‚ÄúA  I st  s z     t    f   \nth    m       s   t     f        y   ff    t     q  t   s,‚Äù BIT Numerical \nMathematics, vol. 28, pp. 270-287, 1988. \n[26] M. Schmidt, D. A√ümann et al., ‚ÄúG s  b‚ÄîA Library of Gas Network \nI st    s,‚Äù Data, vol. 2, no. 4, 2017. \n[27] S. Zhang, W. Gu et al., ‚ÄúA   ys s f     t g  t       gy syst m: \nB   hm  k  g m th  s      m   m  t t   ,‚Äù Energy Internet, vol. 1, no. \n1, pp. 63-80, 2024. \n \nTABLE II \nRMSES OF DIFFERENT METHODS \nVariable \nM2-120s \nM2-10s \nM2-5s \nM3-10s \nM4 \nùëí \n1.614e-2 \n8.222e-3 \n3.357e-3 \n8.222e-3 \n4.242e-3 \nùëì \n2.741e-2 \n1.390e-2 \n5.674e-3 \n1.390e-2 \n7.199e-3 \nùëöùëùùëô \n3.605e-1 \n8.950e-2 \n6.509e-2 \n1.299e-1 \n9.317e-2 \nùëùùëõùëë \n1.378e3 \n3.047e2 \n1.157e2 \n3.158e2 \n1.743e2 \nTABLE III \nCOMPUTATIONAL COST OF DIFFERENT METHODS \nMethods \nM2-120s \nM2-10s \nM2-5s \nM3-10s \nM4 \nTime Cost(s) \n6.7 \n63.7 \n126.6 \n84.6 \n56.8 \nStep Number \n180 \n2160 \n4320 \n2160 \n2586 \n\n\n",
  "metadata": {
    "source_file": "dataset/pdfs/arxiv_2502.20022v1.pdf",
    "total_pages": 10,
    "title": "Dynamic Energy Flow Analysis of Integrated Electricity and Gas Systems: A Semi-Analytical Approach",
    "authors": [
      "Zhikai Huang",
      "Shuai Lu",
      "Wei Gu",
      "Ruizhi Yu",
      "Suhan Zhang",
      "Yijun Xu",
      "Yuan Li"
    ],
    "abstract": "Ensuring the safe and reliable operation of integrated electricity and gas\nsystems (IEGS) requires dynamic energy flow (DEF) simulation tools that achieve\nhigh accuracy and computational efficiency. However, the inherent strong\nnonlinearity of gas dynamics and its bidirectional coupling with power grids\nimpose significant challenges on conventional numerical algorithms,\nparticularly in computational efficiency and accuracy. Considering this, we\npropose a novel non-iterative semi-analytical algorithm based on differential\ntransformation (DT) for DEF simulation of IEGS. First, we introduce a\nsemi-discrete difference method to convert the partial differential algebraic\nequations of the DEF model into ordinary differential algebraic equations to\nresort to the DT. Particularly, by employing spatial central difference and\nnumerical boundary extrapolation, we effectively avoid the singularity issue of\nthe DT coefficient matrix. Second, we propose a DT-based semi-analytical\nsolution method, which can yield the solution of the DEF model by recursion.\nFinally, simulation results demonstrate the superiority of the proposed method.",
    "published_date": "2025-02-27",
    "source": "arxiv"
  }
}